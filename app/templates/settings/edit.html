{% extends "base.html" %}

{% block content %}
<div class="bg-white shadow rounded-lg">
    <div class="px-6 py-4 border-b border-gray-200">
        <h2 class="text-xl font-semibold text-gray-900">Einstellungen bearbeiten</h2>
    </div>

    <form method="POST" action="/settings/edit" class="px-6 py-6 space-y-6">
        <!-- Organisation -->
        <div>
            <h3 class="text-lg font-medium text-gray-900 mb-4">Organisation</h3>
            <div class="space-y-4">
                <div>
                    <label for="organization_name" class="block text-sm font-medium text-gray-700">Organisationsname *</label>
                    <input
                        type="text"
                        name="organization_name"
                        id="organization_name"
                        value="{{ setting.organization_name }}"
                        required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                        placeholder="z.B. Freizeit-Kassen-System"
                    >
                    <p class="mt-1 text-sm text-gray-500">Wird auf der Rechnung als Absender angezeigt</p>
                </div>

                <div>
                    <label for="organization_address" class="block text-sm font-medium text-gray-700">Adresse</label>
                    <textarea
                        name="organization_address"
                        id="organization_address"
                        rows="3"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                        placeholder="Straße und Hausnummer&#10;PLZ Ort"
                    >{{ setting.organization_address }}</textarea>
                    <p class="mt-1 text-sm text-gray-500">Absender-Adresse auf der Rechnung</p>
                </div>
            </div>
        </div>

        <hr class="border-gray-200">

        <!-- Bankdaten -->
        <div>
            <h3 class="text-lg font-medium text-gray-900 mb-4">Bankdaten</h3>
            <div class="space-y-4">
                <div>
                    <label for="bank_account_holder" class="block text-sm font-medium text-gray-700">Kontoinhaber *</label>
                    <input
                        type="text"
                        name="bank_account_holder"
                        id="bank_account_holder"
                        value="{{ setting.bank_account_holder }}"
                        required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                        placeholder="z.B. Verein e.V."
                    >
                </div>

                <div>
                    <label for="bank_iban" class="block text-sm font-medium text-gray-700">IBAN *</label>
                    <input
                        type="text"
                        name="bank_iban"
                        id="bank_iban"
                        value="{{ setting.bank_iban }}"
                        required
                        pattern="[A-Z]{2}[0-9]{2}[\s]?([0-9]{4}[\s]?){3,7}[0-9]{1,4}"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm font-mono"
                        placeholder="DE89 3704 0044 0532 0130 00"
                    >
                    <p class="mt-1 text-sm text-gray-500">Internationale Bankkontonummer (IBAN)</p>
                </div>

                <div>
                    <label for="bank_bic" class="block text-sm font-medium text-gray-700">BIC (optional)</label>
                    <input
                        type="text"
                        name="bank_bic"
                        id="bank_bic"
                        value="{{ setting.bank_bic or '' }}"
                        pattern="[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm font-mono"
                        placeholder="COBADEFFXXX"
                    >
                    <p class="mt-1 text-sm text-gray-500">Bank Identifier Code (BIC/SWIFT)</p>
                </div>
            </div>
        </div>

        <hr class="border-gray-200">

        <!-- Rechnungs-Einstellungen -->
        <div>
            <h3 class="text-lg font-medium text-gray-900 mb-4">Rechnungs-Einstellungen</h3>
            <div class="space-y-4">
                <div>
                    <label for="invoice_subject_prefix" class="block text-sm font-medium text-gray-700">Betreff-Präfix</label>
                    <input
                        type="text"
                        name="invoice_subject_prefix"
                        id="invoice_subject_prefix"
                        value="{{ setting.invoice_subject_prefix or 'Teilnahme an' }}"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                        placeholder="z.B. Teilnahme an"
                    >
                    <p class="mt-1 text-sm text-gray-500">Wird vor dem Event-Namen auf der Rechnung angezeigt</p>
                </div>

                <div>
                    <label for="invoice_footer_text" class="block text-sm font-medium text-gray-700">Fußzeilen-Text</label>
                    <textarea
                        name="invoice_footer_text"
                        id="invoice_footer_text"
                        rows="2"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                        placeholder="z.B. Vielen Dank für Ihre Zahlung!"
                    >{{ setting.invoice_footer_text or 'Vielen Dank für Ihre Zahlung!' }}</textarea>
                    <p class="mt-1 text-sm text-gray-500">Text am Ende der Zahlungsinformationen</p>
                </div>
            </div>
        </div>

        <hr class="border-gray-200">

        <!-- Regelwerk-Einstellungen -->
        <div>
            <h3 class="text-lg font-medium text-gray-900 mb-4">Regelwerk-Einstellungen</h3>
            <div class="space-y-4">
                <div>
                    <label for="default_github_repo" class="block text-sm font-medium text-gray-700">Standard GitHub-Repository</label>
                    <input
                        type="url"
                        name="default_github_repo"
                        id="default_github_repo"
                        value="{{ setting.default_github_repo or '' }}"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                        placeholder="https://raw.githubusercontent.com/user/repo/main/ruleset.yaml"
                    >
                    <p class="mt-1 text-sm text-gray-500">Wird beim Regelwerk-Import automatisch vorausgefüllt</p>
                </div>
            </div>
        </div>

        <hr class="border-gray-200">

        <!-- Hinweis -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-yellow-700">
                        <strong>Wichtig:</strong> Diese Einstellungen gelten nur für <strong>{{ event.name }}</strong>. Änderungen werden auf allen zukünftigen Rechnungen für dieses Event angezeigt.
                    </p>
                </div>
            </div>
        </div>

        <!-- Buttons -->
        <div class="flex justify-end space-x-3">
            <a href="/settings" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition">
                Abbrechen
            </a>
            <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition">
                <svg class="h-5 w-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Speichern
            </button>
        </div>
    </form>
</div>
{% endblock %}
